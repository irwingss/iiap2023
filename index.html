<!DOCTYPE html>
<html lang="es"><head>
<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/tabby.min.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.280">

  <meta name="author" content="Profesor: Irwing S. Saldaña">
  <title> Capacitación y actualización del equipo de investigación en programas estadísticos</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="fondo.png" data-background-opacity="1" data-background-size="cover" class="quarto-title-block center">
  <h1 class="title"><br>Capacitación y actualización del equipo de investigación en programas estadísticos</h1>
  <p class="subtitle">IIAP 2023</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Profesor: Irwing S. Saldaña 
</div>
</div>
</div>

  <p class="date">2/3/23</p>
</section>
<section>
<section id="modelos-lineales" class="title-slide slide level1 center" data-background-image="fondoh1.png">
<h1>Modelos lineales</h1>
<div class="cell" data-hash="index_cache/revealjs/unnamed-chunk-1_5b6add03e27ea0646b3d7279f1c953b4">

</div>
</section>
<section id="modelo-lineal" class="slide level2">
<h2>Modelo lineal</h2>
<p>Un modelo lineal sigue la siguiente ecuación:</p>
<span class="math display">\[
\Large{y =\beta_0 + \sum_{i=1}^{n}(\beta_i*x_i) + \varepsilon}
\]</span>
<center>
Donde: <span class="math inline">\(\varepsilon \sim \mathcal{N}(0,\sigma)\)</span>, <span class="math inline">\(\beta_0\)</span> es el intercepto en <span class="math inline">\(Y\)</span>, y <span class="math inline">\(\beta_i\)</span> la pendiente de la variable <span class="math inline">\(X_i\)</span>.
</center>
<p><br></p>
<ul>
<li class="fragment"><p>Abstracción de la realidad más simple posible.</p></li>
<li class="fragment"><p>Pocos eventos naturales son lineales.</p></li>
<li class="fragment"><p>La distribución asociada al modelo lineal es la <strong>distribución Gaussiana o Normal</strong>.</p></li>
<li class="fragment"><p>El cálculo de los coeficientes <span class="math inline">\(\beta_i\)</span> se realiza mediante OLS o ML.</p></li>
</ul>
</section>
<section id="teoría-básica-ols-cálculo-de-coeficientes" class="slide level2">
<h2>Teoría básica OLS: cálculo de coeficientes</h2>
<p>La forma más sencilla de encontrar los coeficientes de una función lineal es utilizando el método de los mínimos cuadrados ordinarios (OLS). Para esta sección utilizaremos las formulas definidas a continuación:</p>
<div>
<ul>
<li>La fórmula de un modelo lineal se define como:</li>
</ul>
<p><span class="math display">\[
\large{y_i = \beta_0 + \sum_{i=1}^n{(\beta_ix_i)}+\varepsilon_i}
\]</span></p>
<ul>
<li>Para el <strong>cálculo del coeficiente de una variable <span class="math inline">\(X\)</span> (<span class="math inline">\(\beta_i\)</span>)</strong>, se utilizan los valores de cada observación <span class="math inline">\(x\)</span>, el promedio del vector de la variable x <span class="math inline">\(\bar{x}\)</span>, los valores de cada observación <span class="math inline">\(y\)</span>, el promedio del vector de la variable <span class="math inline">\(X\)</span> <span class="math inline">\(\bar{y}\)</span>, en la siguiente fórmula:</li>
</ul>
<p><span class="math display">\[
\large{\hat\beta_i=\frac{\sum_i (x_i\bar{x})(y_i\bar{y})}{\sum_i (x_i\bar{x})^2}}
\]</span></p>
</div>
</section>
<section id="section" class="slide level2">
<h2></h2>
<div>
<ul>
<li>Una vez calculados los coeficientes <span class="math inline">\(\beta_i\)</span> se realiza el <strong>cálculo de <span class="math inline">\(\beta_0\)</span>:</strong></li>
</ul>
<p><span class="math display">\[
\large{\hat\beta_0=\bar{y} - \hat\beta_1\bar{x}}
\]</span></p>
<ul>
<li>Un paso previo para el cálculo del p-valor asociado a un coeficiente del modelo lineal, es el <strong>estimar el error estándar del coeficiente</strong>. Esto es homólogo al cálculo de la desviación estándar del coeficiente, por lo que la raíz cuadrada de la fórmula de la varianza del coeficiente nos ayudará en el cálculo de <span class="math inline">\(\widehat{\text{se}}(\hat{b})\)</span>:</li>
</ul>
<p><span class="math display">\[
\large{\widehat{\text{se}}(\hat{b_i})  = \sqrt{\widehat{\textrm{Var}}(\hat{b_i})} = \sqrt{\frac{n \hat{\sigma}^2}{n\sum x_i^2 - (\sum x_i)^2}}}
\]</span></p>
</div>
</section>
<section id="section-1" class="slide level2">
<h2></h2>
<div>
<ul>
<li>Donde <span class="math inline">\(\hat{\sigma}^2\)</span> es el error cuadrado medio, definido por la fórmula:</li>
</ul>
<p><span class="math display">\[
\large{\hat{\sigma}^2 = \frac{1}{n-2} \sum_i \hat{\varepsilon}_i^2}
\]</span></p>
<ul>
<li>De manera similar, se calcula el error estándar del intercepto <span class="math inline">\(\widehat{\text{se}}(\hat{b_0})\)</span>:</li>
</ul>
<p><span class="math display">\[
\large{\widehat{\text{se}}(\hat{b_0})  = \sqrt{\widehat{\textrm{Var}}(\hat{b_0})} = \sqrt{\frac{\hat{\sigma}^2\bar{x}^2}{\sum_{i=1}^n(x_i-\bar{x})^2}}}
\]</span></p>
</div>
</section>
<section id="asunciones-teóricas-del-modelo-lineal" class="slide level2">
<h2>Asunciones teóricas del modelo lineal</h2>
<ul>
<li class="fragment">A1: Variable dependiente numérica continua.</li>
<li class="fragment">A2: Linealidad de la relación.</li>
<li class="fragment">A3: Normalidad de los residuales.</li>
<li class="fragment">A4: Independencia de los residuales.</li>
<li class="fragment">A5: Homocedasticidad de los residuales.</li>
<li class="fragment">A6: Ausencia de valores influyentes.</li>
<li class="fragment">A7: No multicolinearidad entre las variables independientes.</li>
</ul>
</section>
<section id="section-2" class="slide level2">
<h2></h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center" data-hash="index_cache/revealjs/fig-asunciones-lm_cb7e7fdb0e272ebcd09caf3b09bbefb9">
<div class="cell-output-display">
<div id="fig-asunciones-lm" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/multiplot.png" style="width:97.0%"></p>
<p></p><figcaption>Figura&nbsp;1: Multiplot de asunciones teóricas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<h2>
Revisión rápida de las asunciones teóricas
</h2>
<div class="cell" data-hash="index_cache/revealjs/unnamed-chunk-3_9b25c86cf9d91145035457fc4a85946f">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, </span>
<span id="cb1-2"><a href="#cb1-2"></a>             <span class="at">data =</span> mis_datos)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(performance)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">check_model</span>(modelo)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="a2-linealidad-de-la-relación" class="slide level2">
<h2>A2: Linealidad de la relación</h2>

<img data-src="index_files/figure-revealjs/fig-00linealidad-1.svg" style="width:100.0%" class="r-stretch quarto-figure-center"><p class="caption">Figura&nbsp;2: <b>Falta de linealidad</b> en la relación entre X e Y. Es un monotónico pero no lineal.</p></section>
<section id="a5-homocedasticidad-de-los-residuales" class="slide level2">
<h2>A5: Homocedasticidad de los residuales</h2>

<img data-src="index_files/figure-revealjs/fig-01homocedasticidad-1.svg" style="width:100.0%" class="r-stretch quarto-figure-center"><p class="caption">Figura&nbsp;3: Relación entre X e Y es <b>homocedástica</b>. Línea negra cuantil 0.5; líneas punteadas azules cuantiles 0.25 y 0.75; líneas punteadas naranja cuantiles 0.05 y 0.95.</p></section>
<section id="a5-homocedasticidad-de-los-residuales-1" class="slide level2">
<h2>A5: Homocedasticidad de los residuales</h2>

<img data-src="index_files/figure-revealjs/fig-02heterocedasticidad-1.svg" style="width:100.0%" class="r-stretch quarto-figure-center"><p class="caption">Figura&nbsp;4: Este gráfico presenta <b>problemas de Heterocedasticidad</b>. Línea negra cuantil 0.5; líneas punteadas azules cuantiles 0.25 y 0.75; líneas punteadas naranja cuantiles 0.05 y 0.95.</p></section>
<section id="a5-homocedasticidad-de-los-residuales-2" class="slide level2">
<h2>A5: Homocedasticidad de los residuales</h2>

<img data-src="index_files/figure-revealjs/fig-03heterochequeo-1.svg" style="width:100.0%" class="r-stretch quarto-figure-right"><p class="caption">Figura&nbsp;5: Gráfico de Residuales vs Valores ajustados.</p></section>
<section id="a7-problema-de-multicolinearidad" class="slide level2">
<h2>A7: Problema de multicolinearidad</h2>

<img data-src="index_files/figure-revealjs/fig-05multico-test-1.svg" style="width:100.0%" class="r-stretch quarto-figure-center"><p class="caption">Figura&nbsp;6: Variance Inflation Factor (VIF) para identificar problemas de multicolinearidad.</p></section>
<section id="razones-para-escoger-un-modelo-lineal" class="slide level2">
<h2>Razones para escoger un modelo lineal</h2>
<ul>
<li class="fragment">Mi variable dependiente (respuesta, o Y) es numérica continua (<strong>mediciones</strong>).</li>
<li class="fragment">El fenómeno evaluado puede producir <strong>valores numéricos negativos</strong>.</li>
<li class="fragment">Los gráficos relacionando la variable dependiente con cada variable independiente numérica muestran <strong>linealidad</strong> (no monotonicidad).</li>
</ul>
</section>
<section id="chequeo-de-distribución-gráfico-de-cullen-y-frey" class="slide level2">
<h2>Chequeo de distribución: Gráfico de Cullen y Frey</h2>

<img data-src="index_files/figure-revealjs/fig-06cullenfrey-1.svg" style="width:100.0%" class="r-stretch quarto-figure-center"><p class="caption">Figura&nbsp;7: El punto azul oscuro son los datos observados. Los amarillos, los 1000 bootstrap realizados sobre los datos.</p><div class="cell" data-hash="index_cache/revealjs/fig-06cullenfrey-code_22ce06fb47c89eba4d2a54aec2909b47">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>fitdistrplus<span class="sc">::</span><span class="fu">descdist</span>(observaciones, <span class="at">boot =</span> <span class="dv">1000</span>, <span class="at">discrete =</span> <span class="cn">FALSE</span>) <span class="co">#DC</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>fitdistrplus<span class="sc">::</span><span class="fu">descdist</span>(observaciones, <span class="at">boot =</span> <span class="dv">1000</span>, <span class="at">discrete =</span> <span class="cn">TRUE</span>) <span class="co">#DD</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="comparación-de-distribuciones-de-probabilidades" class="slide level2">
<h2>Comparación de distribuciones de probabilidades</h2>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-hash="index_cache/revealjs/unnamed-chunk-11_3ac9bd51ec6ac56146c9610ae8f9572b">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-11-1.svg"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-hash="index_cache/revealjs/unnamed-chunk-12_72e653914534f56e6e17f192f42849e1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">library</span>(JWileymisc)</span>
<span id="cb3-2"><a href="#cb3-2"></a>comp1 <span class="ot">&lt;-</span> </span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="fu">testDistribution</span>(observ, </span>
<span id="cb3-4"><a href="#cb3-4"></a>    <span class="at">distr=</span><span class="st">"normal"</span>, </span>
<span id="cb3-5"><a href="#cb3-5"></a>    <span class="at">extremevalues=</span><span class="st">"empirical"</span>)</span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="fu">plot</span>(comp1)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center" data-hash="index_cache/revealjs/unnamed-chunk-13_061819f2fd4109214d9e100aa58bc452">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-13-1.svg"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-hash="index_cache/revealjs/unnamed-chunk-14_96d266f8e0bef83f9a5c7e16ab01a30b">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">library</span>(JWileymisc)</span>
<span id="cb4-2"><a href="#cb4-2"></a>comp2 <span class="ot">&lt;-</span>  </span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="fu">testDistribution</span>(observ, </span>
<span id="cb4-4"><a href="#cb4-4"></a>    <span class="at">distr=</span><span class="st">"gamma"</span>, </span>
<span id="cb4-5"><a href="#cb4-5"></a>    <span class="at">extremevalues=</span><span class="st">"empirical"</span>)</span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="fu">plot</span>(comp2)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="alternativas-al-modelo-lineal" class="slide level2">
<h2>Alternativas al modelo lineal</h2>
<p>Existen alternativas para cuando se violan las asunciones teóricas del modelo lineal. Asegúrate de encontrar el modelo adecuado en lugar de forzar los datos a un modelo que no le corresponde:</p>
<ul>
<li class="fragment">A1: Variable dependiente numérica continua <span class="math inline">\(\rightarrow\)</span> <strong>(GLM)</strong>.</li>
<li class="fragment">A2: Linealidad de la relación <span class="math inline">\(\rightarrow\)</span> <strong>(Modelamiento no lineal &nbsp;Transformación)</strong>.</li>
<li class="fragment">A3: Normalidad de los residuales <span class="math inline">\(\rightarrow\)</span> <strong>(GLM)</strong>.</li>
<li class="fragment">A4: Independencia de los residuales <span class="math inline">\(\rightarrow\)</span> <strong>(Efectos mixtos)</strong>.</li>
<li class="fragment">A5: Homocedasticidad de los residuales <span class="math inline">\(\rightarrow\)</span> <strong>(WLS)</strong>.</li>
<li class="fragment">A6: Ausencia de valores influyentes <span class="math inline">\(\rightarrow\)</span> <strong>(Data cleaning)</strong>.</li>
<li class="fragment">A7: No multicolinearidad entre las variables independientes <span class="math inline">\(\rightarrow\)</span> <strong>(Modelos Log lineares)</strong>.</li>
</ul>
</section></section>
<section>
<section id="regresiones-logarítmicas" class="title-slide slide level1 center" data-background-image="fondoh1.png">
<h1>Regresiones logarítmicas</h1>

</section>
<section id="introducción-a-regresiones-logarítmicas" class="slide level2">
<h2>Introducción a regresiones logarítmicas</h2>
<div class="columns">
<div class="column" style="width:30%;">
<p>Los modelos logarítmicos se utilizan en situaciones en las que existe un <strong>rápido decaimiento/aumento</strong> en la relación entre dos variables, implicando una evidente falta de linealidad en dicha relación. Pueden ser:</p>
<ul>
<li class="fragment">Regresión Log-linear.</li>
<li class="fragment">Regresión Linear-log.</li>
<li class="fragment">Regresión Log-log.</li>
</ul>
</div><div class="column" style="width:70%;">
<div class="cell" data-layout-align="center" data-hash="index_cache/revealjs/fig-04logreg_e5763eb24ed175a2d791e2a39d30066d">
<div class="cell-output-display">
<div id="fig-04logreg" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="index_files/figure-revealjs/fig-04logreg-1.svg" style="width:100.0%"></p>
<p></p><figcaption>Figura&nbsp;8: Relación no lineal entre X e Y. El modelo lineal clásico no ajusta correctamente los datos.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="section-3" class="slide level2">
<h2></h2>
<p><strong>Ecuación del modelo Linear clásico:</strong> <span class="math display">\[
\normalsize{y =\beta_0 + \sum_{i=1}^{n}(\beta_i*x_i) + \varepsilon}
\]</span></p>
<p><strong>Ecuación del modelo Log-Linear:</strong> <span class="math display">\[
\normalsize{\log(y) =\beta_0 + \sum_{i=1}^{n}(\beta_i*x_i) + \varepsilon}
\]</span></p>
<p><strong>Ecuación del modelo Linear-Log:</strong> <span class="math display">\[
\normalsize{y =\beta_0 + \sum_{i=1}^{n}(\beta_i*\log(x_i)) + \varepsilon}
\]</span> <strong>Ecuación del modelo Log-Log:</strong> <span class="math display">\[
\normalsize{\log(y) =\beta_0 + \sum_{i=1}^{n}(\beta_i*\log(x_i)) + \varepsilon}
\]</span></p>
</section>
<section id="section-4" class="slide level2">
<h2></h2>
<div class="fragment">
<div>
<p><strong>Ecuación del modelo lineal clásico:</strong></p>
<ul>
<li>Una unidad de aumento en <span class="math inline">\(X\)</span> genera <span class="math inline">\(\beta\)</span> unidades de cambio en <span class="math inline">\(Y\)</span>.</li>
</ul>
</div>
</div>
<div class="fragment">
<div>
<p><strong>Ecuación del modelo Log-Linear:</strong></p>
<ul>
<li>Una unidad de aumento en <span class="math inline">\(X\)</span> (<span class="math inline">\(\Delta_X = 1\)</span>) genera un cambio porcentual en <span class="math inline">\(Y\)</span> (<span class="math inline">\(\Delta_Y\)</span>) especificado como:<span class="math inline">\(\Delta_Y = 100*(e^{\beta*\Delta_X}-1)\)</span></li>
</ul>
</div>
</div>
<div class="fragment">
<div>
<p><strong>Ecuación del modelo Linear-Log:</strong></p>
<ul>
<li>Un 1% de aumento en <span class="math inline">\(X\)</span> (<span class="math inline">\(\Delta_X = 1 + \text{aumento} = 1 + 0.01 = 1.01\)</span>) genera un cambio de <span class="math inline">\(\beta*\Delta_X\)</span> unidades de cambio en <span class="math inline">\(Y\)</span> (<span class="math inline">\(\Delta_Y\)</span>). Por consiguiente:<span class="math inline">\(\Delta_Y = \beta*\Delta_X\)</span></li>
</ul>
</div>
</div>
<div class="fragment">
<div>
<p><strong>Ecuación del modelo Log-Log:</strong></p>
<ul>
<li>Un 1% de aumento en <span class="math inline">\(X\)</span> (<span class="math inline">\(\Delta_X = 1 + \text{aumento} = 1 + 0.01 = 1.01\)</span>) genera un cambio porcentual en <span class="math inline">\(Y\)</span> (<span class="math inline">\(\Delta_Y\)</span>) especificado como:<span class="math inline">\(\Delta_Y = 100*(e^{\beta*\ln{\Delta_X}}-1)\)</span></li>
</ul>
</div>
</div>
</section>
<section id="section-5" class="slide level2">
<h2></h2>
<div class="columns">
<div class="column" style="width:30%;">
<h2>
<strong>¿Cuándo usar Log-Linear?</strong>
</h2>
<p>Se recomienda utilizar la regresión Log-Linear cuando la distribución de la variable de respuesta sigue una distribución de Poisson <span class="math inline">\(Y \sim \text{Poisson}(\lambda)\)</span> o Exponencial Negativa <span class="math inline">\(Y \sim \text{Exp}(\lambda)\)</span>, y cuando la relación entre la variable de respuesta y las variables predictoras no es lineal.</p>
</div><div class="column" style="width:70%;">
<div class="cell" data-layout-align="center" data-hash="index_cache/revealjs/fig-05loglinear_fb9be45112d22f4fd7980256a96e28d6">
<div class="cell-output-display">
<div id="fig-05loglinear" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="index_files/figure-revealjs/fig-05loglinear-1.svg" style="width:100.0%"></p>
<p></p><figcaption>Figura&nbsp;9: El modelo lineal presenta errores de predicción en las colas de la nube de puntos (A). La regresión log-linear corrige estos errores (B).</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="section-6" class="slide level2">
<h2></h2>
<div class="columns">
<div class="column" style="width:30%;">
<h2>
<strong>¿Cuándo usar Linear-Log?</strong>
</h2>
<p>Se recomienda utilizar la regresión Linear-Log cuando la relación entre las variables dependiente <span class="math inline">\(Y\)</span> e independiente <span class="math inline">\(X\)</span> es exponencial, conociendo que la variable dependiente encaja con las asunciones del modelo lineal.</p>
</div><div class="column" style="width:70%;">
<div class="cell" data-layout-align="center" data-hash="index_cache/revealjs/fig-06linearlog_22b544b792bc6b7f1f5ba25981530b14">
<div class="cell-output-display">
<div id="fig-06linearlog" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="index_files/figure-revealjs/fig-06linearlog-1.svg" style="width:100.0%"></p>
<p></p><figcaption>Figura&nbsp;10: El modelo lineal no ajusta correctamente la nube de puntos (A). La relación entre las variables es no lineal y logarítmica, y se corrige con el modelo Log-Log.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="section-7" class="slide level2">
<h2></h2>
<div class="columns">
<div class="column" style="width:30%;">
<h2>
<strong>¿Cuándo usar Log-Log?</strong>
</h2>
<p>Se recomienda utilizar la regresión Log-Log cuando se espera que la relación entre las variables sea no lineal y logarítmica (alta correlación entre los logaritmos de ambas variables), y cuando se espera que los cambios porcentuales sean más importantes que los cambios absolutos.</p>
</div><div class="column" style="width:70%;">
<div class="cell" data-layout-align="center" data-hash="index_cache/revealjs/fig-07loglog_2a851d691990439b1d2196941ceb7c56">
<div class="cell-output-display">
<div id="fig-07loglog" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="index_files/figure-revealjs/fig-07loglog-1.svg" style="width:100.0%"></p>
<p></p><figcaption>Figura&nbsp;11: El modelo lineal no ajusta correctamente la nube de puntos (A). La relación entre las variables es no lineal y logarítmica, y se corrige con la regresíón Log-Log.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="weighed-least-squares-wls" class="title-slide slide level1 center" data-background-image="fondoh1.png">
<h1>Weighed Least Squares<br>(WLS)</h1>

</section>
<section id="regresión-lineal-ponderada" class="slide level2">
<h2>Regresión Lineal Ponderada</h2>
<div class="columns">
<div class="column" style="width:30%;">
<ul>
<li class="fragment">Todos los <span class="math inline">\(\varepsilon_i\)</span> del modelo OLS tienen la misma función de probabilidad, y por tanto la misma varianza (homocedasticidad).</li>
<li class="fragment">Si no se cumple, nosotros le otorgamos a cada observación un peso para uniformizar la varianza.</li>
<li class="fragment">No afecta los <span class="math inline">\(\beta_i\)</span>, afecta los errores estándar.</li>
</ul>
</div><div class="column" style="width:70%;">
<div class="cell" data-layout-align="center" data-hash="index_cache/revealjs/fig-08WLS_6c7b977c6bf8c59c31570b372cc87f43">
<div class="cell-output-display">
<div id="fig-08WLS" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="index_files/figure-revealjs/fig-08WLS-1.svg" style="width:100.0%"></p>
<p></p><figcaption>Figura&nbsp;12: Problema de heterocedasticidad.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="teoría-básica-dónde-se-modifican-los-pesos" class="slide level2">
<h2>Teoría básica: ¿dónde se modifican los pesos?</h2>
<div>
<ul>
<li><p>Permitiendo que <span class="math inline">\(\large{y_i = \beta_0 + \sum_{i=1}^n{(\beta_ix_i)}+\varepsilon_i}\)</span></p></li>
<li><p>Conociendo que la PDF Gaussiana con Máxima Verosimilitud es:</p></li>
</ul>
<p><span class="math display">\[
\large{L=\prod_{i=1}^n \mathbb{P}(\varepsilon_i)\Bigg[-\frac{1}{2} \sum_{i=1}^n \frac{\varepsilon^2}{\sigma^2}\Bigg]}
\]</span> Siendo <span class="math inline">\(\large{X^2=\sum_{i=1}^n\frac{(O_i-C_i)^2}{\sigma^2}}\)</span>, entonces:</p>
<p><span class="math inline">\(w_i=\frac{1}{\sigma^2}\)</span> la función Chi-cuadrado se despeja: <span class="math inline">\(X^2=\sum_{i=1}^nw_i\varepsilon^2\)</span>, y sabiendo que <span class="math inline">\(\varepsilon_i=y_i-(\beta_0+\beta_ix_i)\)</span>, se aplican derivadas a la función gaussiana para obtener:</p>
<span class="math display">\[\large{b_0=\bar{y}_w-b_i\bar{x}_iw}\]</span> Donde:<span class="math inline">\(\bar{y}\)</span> y <span class="math inline">\(\bar{x}\)</span> son los <strong>promedios ponderados</strong>.
<center>
<span class="math inline">\(\large{\bar{y}=\frac{\sum{w_iy_i}}{\sum{w_i}}}\)</span> y <span class="math inline">\(\large{\bar{x}=\frac{\sum{w_ix_i}}{\sum{w_i}}}\)</span>
</center>
</div>
</section>
<section id="definir-pesos-en-nuestro-modelo" class="slide level2">
<h2>Definir pesos en nuestro modelo</h2>
<p>Se utilizará el enfoque donde <span class="math inline">\(w_i=\frac{1}{\sigma^2}\)</span> pero considerando como estimador de la varianza el valor ajustado <span class="math inline">\(\bar{y}\)</span> por una regresión OLS previa de la siguiente manera:</p>
<div class="cell" data-hash="index_cache/revealjs/unnamed-chunk-20_a78fad38ff61b83c78100e5172729d8e">
<div class="sourceCode cell-code" id="cb5" data-code-line-numbers="1-15|2|5|7|10|12|15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Creando modelo preliminar</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>mod_previo <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> datos)</span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co"># Extrayendo los datos necesarios</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>resid_abs <span class="ot">&lt;-</span> <span class="fu">abs</span>(mod_previo<span class="sc">$</span>residuals)</span>
<span id="cb5-6"><a href="#cb5-6"></a></span>
<span id="cb5-7"><a href="#cb5-7"></a>y_hat <span class="ot">&lt;-</span> mod_previo<span class="sc">$</span>fitted.values</span>
<span id="cb5-8"><a href="#cb5-8"></a></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co"># Obteniendo los pesos</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>mod_w <span class="ot">&lt;-</span><span class="fu">lm</span>(resid_abs <span class="sc">~</span> y_hat)</span>
<span id="cb5-11"><a href="#cb5-11"></a></span>
<span id="cb5-12"><a href="#cb5-12"></a>w <span class="ot">&lt;-</span>  <span class="dv">1</span> <span class="sc">/</span> mod_w<span class="sc">$</span>fitted.values<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb5-13"><a href="#cb5-13"></a></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="co"># Generando regresión WLS</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>mod_wls <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> datos, <span class="at">weights =</span> w)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="regresiones-lasso-ridge" class="title-slide slide level1 center" data-background-image="fondoh1.png">
<h1>Regresiones Lasso &amp; Ridge</h1>

</section>
<section id="problema-de-multicolinearidad" class="slide level2">
<h2>Problema de Multicolinearidad</h2>
<div class="cell" data-hash="index_cache/revealjs/unnamed-chunk-21_329f6daba2515c0d083016f5dd6ccc78">

</div>
<div class="cell" data-hash="index_cache/revealjs/unnamed-chunk-22_b075bdbd53e7768355fcbfe32871a79e">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Funciones para modificar los gráficos de ggpairs</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>lowerFn <span class="ot">&lt;-</span> <span class="cf">function</span>(data, mapping, <span class="at">method =</span> <span class="st">"lm"</span>, ...) {</span>
<span id="cb6-3"><a href="#cb6-3"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> data, <span class="at">mapping =</span> mapping) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>    <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">4</span>, <span class="at">alpha=</span><span class="fl">0.7</span>, <span class="at">color=</span><span class="st">"#4eb8d2"</span>)<span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> method, <span class="at">color =</span> <span class="st">"black"</span>, ...)</span>
<span id="cb6-6"><a href="#cb6-6"></a>  p</span>
<span id="cb6-7"><a href="#cb6-7"></a>}</span>
<span id="cb6-8"><a href="#cb6-8"></a></span>
<span id="cb6-9"><a href="#cb6-9"></a>diagFn <span class="ot">&lt;-</span> <span class="cf">function</span>(data, mapping, ...) {</span>
<span id="cb6-10"><a href="#cb6-10"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> data, <span class="at">mapping =</span> mapping) <span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>    <span class="fu">geom_density</span>(<span class="at">fill=</span><span class="st">"#4e00ff"</span>, <span class="at">color=</span><span class="st">"#4e00ff"</span>)</span>
<span id="cb6-12"><a href="#cb6-12"></a>  p</span>
<span id="cb6-13"><a href="#cb6-13"></a>}</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="problema-de-multicolinearidad-1" class="slide level2">
<h2>Problema de Multicolinearidad</h2>
<div class="cell" data-hash="index_cache/revealjs/unnamed-chunk-23_e6127345fd844a0aee1cc3d0cadaf244">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Generando gráfico EDA con ggpairs</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co"># de la librería GGally</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="fu">ggpairs</span>(iris[,<span class="sc">-</span><span class="dv">5</span>],</span>
<span id="cb7-4"><a href="#cb7-4"></a>        <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(lowerFn)),</span>
<span id="cb7-5"><a href="#cb7-5"></a>        <span class="at">diag =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(diagFn)),</span>
<span id="cb7-6"><a href="#cb7-6"></a>        <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">"cor"</span>, <span class="at">size =</span> <span class="dv">6</span>)))<span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section>
<section id="problema-de-multicolinearidad-1-output" class="slide level2 output-location-slide"><h2>Problema de Multicolinearidad</h2><div class="cell output-location-slide" data-hash="index_cache/revealjs/unnamed-chunk-23_e6127345fd844a0aee1cc3d0cadaf244">
<div class="cell-output-display">
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-23-1.svg"></p>
</div>
</div></section><section id="alternativas-para-resolver-problemas-de-multicolinearidad" class="slide level2">
<h2>Alternativas para resolver<br>problemas de multicolinearidad</h2>
<ul>
<li class="fragment"><p>Si la multicolinearidad es dependiente de tu diseño de muestreo/experimental, considera ampliar la muestra o mejorar el diseño.</p></li>
<li class="fragment"><p>Si la multicolinearidad se debe a la relación entre variables únicamente, puedes aplicar métodos de selección de variables: <strong>Step-wise regression</strong>.</p></li>
<li class="fragment"><p>Si no es óptimo reducir la cantidad de variables en el modelo, usa <strong>Ridge regression</strong> para aplicar penalidades sobre cada variable y reducir su colinearidad.</p></li>
<li class="fragment"><p>Si puedes reducir la cantidad de variables y deseas que la penalidad sea la encargada de eliminar (anular) las variables colineares en el modelo, utiliza <strong>Lasso regression</strong>.</p></li>
</ul>
</section>
<section id="regresión-lasso-regularización-l1-y-regresión-ridge-regularización-l2" class="slide level2">
<h2>Regresión Lasso (regularización L1) y <br> Regresión Ridge (regularización L2)</h2>
<p>Las regresiones con regularización penalizan a cada variable independiente para reducir su efecto en el modelo.</p>
<ul>
<li class="fragment"><p>La <strong>regresión Lasso (L1)</strong> puede penalizar a los coeficientes hasta convertirlos en 0. Esto implica que también reduce el número de variables independientes utilizadas en el modelo.</p></li>
<li class="fragment"><p>La <strong>regresión Ridge (L2)</strong> penaliza a los coeficientes con tendencia a ser 0, pero nunca lo alcanza. No reduce variables independientes.</p></li>
<li class="fragment"><p>Los <strong>coeficientes</strong> de ambas regresiones siempre son <strong>menores que el modelo OLS</strong>.</p></li>
<li class="fragment"><p>El valor <span class="math inline">\(\lambda\)</span> <strong>(lambda) reduce el efecto</strong> de las variables independientes sobre la variable dependiente. Por lo tanto, un alto valor de <span class="math inline">\(\lambda\)</span> crea regresiones con menor pendiente.</p></li>
</ul>
</section>
<section id="section-8" class="slide level2">
<h2></h2>
<div class="cell" data-hash="index_cache/revealjs/unnamed-chunk-24_8a449d38e7eef6ebfe475f7e9066e64a">

</div>

<img data-src="index_files/figure-revealjs/fig-09ridgelasso-1.svg" class="r-stretch quarto-figure-center"><p class="caption">Figura&nbsp;13: Comparativa entre las regresiones OLS (línea negra), Ridge y Lasso. Notar que las regresiones Lasso se superponen totalmente.</p></section>
<section id="regresión-ridge-regularización-l2" class="slide level2">
<h2>Regresión Ridge (regularización L2)</h2>
<div class="cell" data-hash="index_cache/revealjs/unnamed-chunk-26_6a76a28bc007c8586e9f26dea4740bab">

</div>
<p>Coeficientes <strong>OLS (modelo lineal clásico)</strong>:</p>
<div class="cell" data-hash="index_cache/revealjs/unnamed-chunk-27_2972594ddddc58dfe3ee563d6a64660b">
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          V1          V2          V3          V4          V5 
      0.137       0.065      -0.004      -0.147       0.138       0.070 
         V6          V7          V8          V9         V10 
     -0.037       0.093       0.110      -0.049       0.137 </code></pre>
</div>
</div>
<p><br></p>
<p>Considerando una matriz de variables independientes llamada x, y una variable dependiente y, los coeficientes de penalizado con el método <strong>L2</strong> (<strong>Regresión ridge</strong>):</p>
<div class="cell" data-hash="index_cache/revealjs/unnamed-chunk-28_c919ea1707fd30086fcfce5f6261b08c">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Ridge regression </span></span>
<span id="cb9-2"><a href="#cb9-2"></a>ridge.fit <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x, y, <span class="at">alpha=</span><span class="dv">0</span>, <span class="at">lambda=</span><span class="fl">0.1</span>)</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="fu">predict</span>(ridge.fit, <span class="at">type=</span><span class="st">"coefficients"</span>, <span class="at">s=</span><span class="fl">0.1</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,] <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          V1          V2          V3          V4          V5 
      0.136       0.060      -0.006      -0.136       0.130       0.061 
         V6          V7          V8          V9 
     -0.034       0.084       0.102      -0.048 </code></pre>
</div>
</div>
</section>
<section id="regresión-lasso-regularización-l1" class="slide level2">
<h2>Regresión Lasso (regularización L1)</h2>
<p>Coeficientes <strong>OLS (modelo lineal clásico)</strong>:</p>
<div class="cell" data-hash="index_cache/revealjs/unnamed-chunk-29_a6c3140b4871d222d873a3da850a4dd1">
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          V1          V2          V3          V4          V5 
      0.137       0.065      -0.004      -0.147       0.138       0.070 
         V6          V7          V8          V9         V10 
     -0.037       0.093       0.110      -0.049       0.137 </code></pre>
</div>
</div>
<p><br></p>
<p>Considerando una matriz de variables independientes llamada x, y una variable dependiente y, los coeficientes de penalizado con el método <strong>L1</strong> (<strong>Regresión ridge</strong>):</p>
<div class="cell" data-hash="index_cache/revealjs/unnamed-chunk-30_8b2e009ddfccdd8e290648038c690165">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># Lasso regression </span></span>
<span id="cb12-2"><a href="#cb12-2"></a>laso.fit <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x, y, <span class="at">alpha=</span><span class="dv">1</span>, <span class="at">lambda=</span><span class="fl">0.1</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="fu">predict</span>(laso.fit, <span class="at">type=</span><span class="st">"coefficients"</span>, <span class="at">s=</span><span class="fl">0.1</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,] <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          V1          V2          V3          V4          V5 
      0.128       0.000       0.000      -0.062       0.079       0.000 
         V6          V7          V8          V9 
      0.000       0.000       0.029       0.000 </code></pre>
</div>
</div>
</section></section>
<section>
<section id="modelos-generalizados-lineales-glm" class="title-slide slide level1 center" data-background-image="fondoh1.png">
<h1>Modelos Generalizados Lineales (GLM)</h1>

</section>
<section id="reconocimiento-de-la-familia-de-distribución" class="slide level2">
<h2>Reconocimiento de la familia de distribución</h2>
<p>Un concepto clave para comprender los modelos GLM es identificar la familia de distribución de probabilidades a la que nuestros datos de la variable dependiente <span class="math inline">\(Y\)</span> son más afines.</p>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center" data-hash="index_cache/revealjs/unnamed-chunk-31_e0782e299d4ea963e4b3d86f0de6a79a">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-31-1.svg" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column">
<p><br> <br> <br></p>
<div class="cell" data-hash="index_cache/revealjs/unnamed-chunk-32_51b7205a4be19b4ab844d93a62978c55">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">library</span>(JWileymisc)</span>
<span id="cb14-2"><a href="#cb14-2"></a>comp1 <span class="ot">&lt;-</span> </span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="fu">testDistribution</span>(observ, </span>
<span id="cb14-4"><a href="#cb14-4"></a>    <span class="at">distr=</span><span class="st">"normal"</span>, </span>
<span id="cb14-5"><a href="#cb14-5"></a>    <span class="at">extremevalues=</span><span class="st">"empirical"</span>)</span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="fu">plot</span>(comp1)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="cuándo-y-no-es-gaussiana" class="slide level2">
<h2>¿Cuándo <span class="math inline">\(Y\)</span> no es Gaussiana?</h2>
<div class="columns">
<div class="column" style="width:30%;">
<ul>
<li class="fragment"><p>Cuando la variable respuesta es una proporción de un total de conteos: [0,1]</p></li>
<li class="fragment"><p>Cuando la respuesta es binaria (0 o 1): éxito o fracaso.</p></li>
<li class="fragment"><p>Cuando la respuesta es un conteo. Son discretos y no negativos.</p></li>
<li class="fragment"><p>Cuando la respuesta es continua y positiva (datos con asimetría).</p></li>
</ul>
</div><div class="column" style="width:70%;">
<div class="fragment">
<div>
<div class="cell" data-layout-align="center" data-hash="index_cache/revealjs/unnamed-chunk-33_2147872a69845db79f5e117f84b70e46">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/Densidad.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="distribuciones-de-probabilidades-en-glm-1" class="slide level2">
<h2>Distribuciones de probabilidades en GLM 1</h2>
<ol type="1">
<li class="fragment"><p><strong>Normal (Gaussiana):</strong> es la distribución de probabilidad más comúnmente utilizada en modelos de regresión lineal clásicos. Se utiliza cuando se espera que la variable de respuesta tenga una distribución normal.</p></li>
<li class="fragment"><p><strong>Gamma:</strong> se utiliza para variables de respuesta continuas y positivas que no siguen una distribución normal, como los tiempos de espera o las tasas de eventos.</p></li>
<li class="fragment"><p><strong>Inversa Gamma:</strong> se utiliza para variables de respuesta continuas que siguen una distribución normal con varianza heterogénea.</p></li>
<li class="fragment"><p><strong>Inversa Gaussiana:</strong> se utiliza para variables de respuesta continuas que siguen una distribución normal con varianza heterogénea.</p></li>
<li class="fragment"><p><strong>Lognormal:</strong> se utiliza para variables de respuesta continuas y positivas que no siguen una distribución normal, pero que tienen una distribución lognormal.</p></li>
<li class="fragment"><p><strong>Exponencial:</strong> se utiliza para variables de respuesta continuas y positivas que siguen una distribución exponencial, como los tiempos de falla o los tiempos de espera entre eventos.</p></li>
</ol>
</section>
<section id="distribuciones-de-probabilidades-en-glm-1-1" class="slide level2">
<h2>Distribuciones de probabilidades en GLM 1</h2>

<img data-src="index_files/figure-revealjs/fig-010dist1-1.svg" style="width:100.0%" class="r-stretch quarto-figure-center"><p class="caption">Figura&nbsp;14: Principales distribuciones de probabilidades continuas, incluyendo la distribución normal y distribuciones sesgadas.</p></section>
<section id="distribuciones-de-probabilidades-en-glm-2" class="slide level2">
<h2>Distribuciones de probabilidades en GLM 2</h2>
<ol start="7" type="1">
<li class="fragment"><p><strong>Beta:</strong> se utiliza para variables de respuesta continuas que están acotadas entre 0 y 1, como la proporción de personas que aprueban un examen.</p></li>
<li class="fragment"><p><strong>Weibull:</strong> se utiliza para variables de respuesta continuas y positivas que siguen una distribución de Weibull, como los tiempos de falla o los tiempos de espera entre eventos.</p></li>
<li class="fragment"><p><strong>Tweedie:</strong> es una distribución general que incluye muchas de las distribuciones mencionadas anteriormente como casos especiales. Se utiliza cuando la variable de respuesta puede ser positiva, continua o discreta, y cuando se espera que tenga una varianza que depende de la media.</p></li>
</ol>
</section>
<section id="distribuciones-de-probabilidades-en-glm-2-1" class="slide level2">
<h2>Distribuciones de probabilidades en GLM 2</h2>

<img data-src="index_files/figure-revealjs/fig-011dist2-1.svg" style="width:100.0%" class="r-stretch quarto-figure-center"><p class="caption">Figura&nbsp;15: Distribuciones de probabilidades continuas menos frecuentes, incluyendo la distribución normal para la comparación.</p></section>
<section id="distribuciones-de-probabilidades-en-glm-3" class="slide level2">
<h2>Distribuciones de probabilidades en GLM 3</h2>
<ol type="1">
<li class="fragment"><p><strong>Bernoulli (Binomial):</strong> se utiliza para variables de respuesta binarias (éxito/fallo, sí/no) o para variables que se pueden clasificar en dos categorías.</p></li>
<li class="fragment"><p><strong>Poisson:</strong> se utiliza para variables de respuesta con conteos discretos, como el número de eventos en un intervalo de tiempo o en una área.</p></li>
<li class="fragment"><p><strong>Binomial Negativa:</strong> se utiliza para variables de respuesta con conteos discretos que tienen una varianza mayor que su media, como el número de bacterias en una muestra.</p></li>
<li class="fragment"><p><strong>Geométrica:</strong> se utiliza para variables de respuesta con conteos discretos que representan el número de ensayos hasta el primer éxito.</p></li>
<li class="fragment"><p><strong>Logística (Binomial):</strong> se utiliza para variables de respuesta binarias o categóricas que se pueden modelar como una función de la probabilidad de éxito.</p></li>
</ol>
<div class="fragment">
<div>
<div style="width:1024px; height:120px; border:1px solid #4e00ff; background:#cff8ff; padding: 10px;">
<p>Puedes visitar un simulador de distribuciones <a href="https://www.randomservices.org/random/apps/SpecialSimulator.html">aquí.</a></p>
<p>Para mayor detalle matemático sobre cada distribución de la familia exponencial, clic <a href="https://www.randomservices.org/random/special/GeneralExponential.html#">aquí.</a></p>
</div>
</div>
</div>
</section>
<section id="distribuciones-de-probabilidades-en-glm-3-1" class="slide level2">
<h2>Distribuciones de probabilidades en GLM 3</h2>

<img data-src="index_files/figure-revealjs/fig-012dist3-1.svg" style="width:100.0%" class="r-stretch quarto-figure-center"><p class="caption">Figura&nbsp;16: Distribuciones de probabilidades discretas.</p></section>
<section id="teoría-de-los-glm-aspectos-matemáticos" class="slide level2">
<h2>Teoría de los GLM: aspectos matemáticos</h2>
<ul>
<li class="fragment"><p>La distribución de probabilidades de la variable <span class="math inline">\(Y\)</span> debe estar dentro de la familia exponencial.</p></li>
<li class="fragment"><p>El componente sistemático sigue siendo lineal <span class="math inline">\(\eta = \beta_0+\sum_{i=1}^n{(\beta_i*x_i)} + \varepsilon\)</span>.</p></li>
<li class="fragment"><p>La variable dependiente <span class="math inline">\(Y\)</span> (<span class="math inline">\(\mu_i\)</span>) se ajusta a linealidad de <span class="math inline">\(\eta\)</span> a través de una función de enlace <span class="math inline">\(g(Y)\)</span></p></li>
<li class="fragment"><p>Por lo tanto, la función de enlace: <span class="math display">\[
g(\mu) = \eta
\]</span></p></li>
<li class="fragment"><p>Y la función de varianza (con parámetro de dispersión): <span class="math display">\[
Var(Y) = \phi \mu
\]</span></p></li>
</ul>
</section>
<section id="teoría-de-los-glm-función-de-enlace" class="slide level2">
<h2>Teoría de los GLM: función de enlace</h2>
<div class="cell" data-hash="index_cache/revealjs/tbl-01FuncEnlace_11dbe118a9dbfdb129110d1efdadf36b">
<div class="cell-output-display">
<div id="tbl-01FuncEnlace">
<table>
<caption>Tabla&nbsp;1: Funciones de enlace empleadas en modelos GLM.</caption>
<colgroup>
<col style="width: 34%">
<col style="width: 38%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Enlace</th>
<th style="text-align: center;">Función</th>
<th style="text-align: center;">Inversa</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Identidad</td>
<td style="text-align: center;"><span class="math inline">\(\mu\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\mu\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Logit</td>
<td style="text-align: center;"><span class="math inline">\(\ln\left(\frac{\mu}{1-\mu}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\frac{1}{1+e^{-\eta}}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Probit</td>
<td style="text-align: center;"><span class="math inline">\(\Phi^{-1}(\mu)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\Phi(\eta)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Complemento Log-Log</td>
<td style="text-align: center;"><span class="math inline">\(\ln(-\ln(1-\mu))\)</span></td>
<td style="text-align: center;"><span class="math inline">\(1-e^{-e^\eta}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Raíz cuadrada</td>
<td style="text-align: center;"><span class="math inline">\(\sqrt{\mu}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\mu^2\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Logaritmo</td>
<td style="text-align: center;"><span class="math inline">\(\ln(\mu)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(e^\eta\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Raíz cuadrada inversa</td>
<td style="text-align: center;"><span class="math inline">\(\frac{1}{\sqrt{\mu}}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\frac{1}{\mu^2}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Complemento Log-Log (modificado)</td>
<td style="text-align: center;"><span class="math inline">\(\ln(-\ln\mu)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(1-e^{-e^{-\eta}}\)</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="regresión-glm-para-var.-binarias-introducción" class="slide level2">
<h2>Regresión GLM para var. Binarias: introducción</h2>
<h4 id="función-de-enlace-logit">Función de enlace: logit</h4>
<ul>
<li class="fragment"><p>Los modelos logísticos son un tipo de modelo estadístico utilizado para modelar la relación entre una variable binaria (0 o 1) y una o más variables predictoras.</p></li>
<li class="fragment"><p>Binomial y Bernoulli.</p></li>
<li class="fragment"><p>El modelo de regresión logística se define como:</p></li>
</ul>
<div class="fragment">
<div>
<p><span class="math display">\[ \ln \left( \frac{p}{1-p} \right) = \beta_0 + \beta_1 x_1 + \cdots + \beta_p x_p \]</span></p>
<p>Donde:</p>
<p><span class="math inline">\(p\)</span> es la probabilidad de éxito (1) <span class="math inline">\(x_1, \dots, x_p\)</span> son las variables predictoras <span class="math inline">\(\beta_0, \dots, \beta_p\)</span> son los coeficientes de regresión El modelo se ajusta mediante el método de máxima verosimilitud y los coeficientes se interpretan como log odds ratios.</p>
</div>
</div>
</section>
<section id="regresión-glm-para-var.-binarias-interpretación" class="slide level2">
<h2>Regresión GLM para var. Binarias: interpretación</h2>
<ul>
<li class="fragment">Considerando <span class="math inline">\(\eta = \beta_0 + \beta_1 x_1 + \cdots + \beta_n x_n\)</span>, la probabilidad de éxito se puede obtener como:</li>
</ul>
<div class="fragment">
<div>
<p><span class="math display">\[ p = \frac{e^{\eta}}{1+e^{\eta}} \]</span></p>
</div>
</div>
<ul>
<li class="fragment"><p>El coeficiente <span class="math inline">\(\beta_j\)</span> representa el cambio en el <strong>log odds ratio</strong> por cada unidad de cambio en <span class="math inline">\(x_i\)</span>.</p></li>
<li class="fragment"><p>El coeficiente <span class="math inline">\(e^{\beta_j}\)</span> representa el cambio expresado en <strong>odds ratio</strong> por cada unidad de cambio en <span class="math inline">\(x_i\)</span>.</p></li>
</ul>
</section>
<section id="regresión-glm-para-var.-binarias-concepto-de-odds" class="slide level2">
<h2>Regresión GLM para var. Binarias: concepto de odds</h2>
<ol type="1">
<li class="fragment"><strong>Probabilidad:</strong> es la medida de incertidumbre de que un evento suceda. Toma valores entre 0 y 1. Por ejemplo: <em>Probabilidad de que llueva en un día nublado: 80%</em></li>
</ol>
<div class="fragment">
<div>
<p><span class="math display">\[p = 0.8\]</span></p>
</div>
</div>
<ol start="2" type="1">
<li class="fragment"><strong>Posibilidad (odds):</strong> es la razón de dos probabilidades. Se interpreta como la relación entre la probabilidad de que ocurra un evento <span class="math inline">\(p\)</span> y la probabilidad de que no ocurra <span class="math inline">\(q = 1 - p\)</span>. Considera que siempre <span class="math inline">\(p + q = 1\)</span>. Toma valores entre 0 e <span class="math inline">\(+\infty\)</span>. Por ejemplo: <em>La probabilidad de que llueva en un día nublado es 4 veces la probabilidad de que no llueva</em>, o en su defecto <em>La probabilidad de que llueva en un día nublado es 3 veces más la probabilidad de que no llueva</em>:</li>
</ol>
<div class="fragment">
<div>
<p><span class="math display">\[Odds = \frac{p}{q} = \frac{p}{1-p} = \frac{0.8}{0.2}\]</span></p>
</div>
</div>
</section>
<section id="regresión-glm-para-var.-binarias-concepto-de-odds-ratio" class="slide level2">
<h2>Regresión GLM para var. Binarias: <br>concepto de odds ratio</h2>
<ol start="3" type="1">
<li class="fragment"><strong>Ratio de Posibilidades (odds ratio):</strong> es la razón de las posibilidades (odds) de que ocurra un evento en un grupo en comparación con un grupo de referencia (nivel base). Toma valores entre <span class="math inline">\(-\infty\)</span> e <span class="math inline">\(+\infty\)</span>, siendo 1 el valor central de no efecto. Por ejemplo: <em>La probabilidad de que llueva en un día nublado es 36 veces la probabilidad de que llueva en un día soleado</em>, o en su defecto <em>La probabilidad de que llueva en un día nublado es 35 veces más la probabilidad de que llueva en un día soleado</em>:</li>
</ol>
<div class="fragment">
<div>
<p><span class="math display">\[OR = \frac{odds_1}{odds_2} = \frac{\frac{p_1}{1 - p_1}}{\frac{p_2}{1 - p_2}} = \frac{\frac{0.8}{0.2}}{\frac{0.1}{0.9}} = \frac{4}{0.111} = 36\]</span></p>
</div>
</div>
</section>
<section id="regresión-glm-para-var.-binarias-interpretación-odds-y-odds-ratio" class="slide level2">
<h2>Regresión GLM para var. Binarias: <br>interpretación Odds y Odds ratio</h2>
<h4 id="odds">Odds</h4>
<ul>
<li class="fragment"><p>Si <span class="math inline">\(\beta_i = 0\)</span> entonces <span class="math inline">\(e^{\beta_1}=1\)</span>, implicando <strong>efecto nulo</strong>. Es decir, <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> no están asociadas.</p></li>
<li class="fragment"><p>Si <span class="math inline">\(\beta_i &gt; 0\)</span> entonces <span class="math inline">\(e^{\beta_1}&gt;1\)</span>, implicando <strong>incremento esperado en las probabilidades</strong>.</p></li>
<li class="fragment"><p>Si <span class="math inline">\(\beta_i &lt; 0\)</span> entonces <span class="math inline">\(e^{\beta_1}&lt;1\)</span>, implicando <strong>disminución esperada en las probabilidades</strong>.</p></li>
</ul>
<h4 id="odds-ratio">Odds ratio</h4>
<ul>
<li class="fragment"><p>Si <span class="math inline">\(\beta_i = 0\)</span> entonces <span class="math inline">\(e^{\beta_1}=1\)</span>, <strong>no hay diferencias</strong> entre el efecto del nivel de estudio vs el nivel base. Causan el mismo efecto sobre <span class="math inline">\(Y\)</span>.</p></li>
<li class="fragment"><p>Si <span class="math inline">\(\beta_i &gt; 0\)</span> entonces <span class="math inline">\(e^{\beta_1}&gt;1\)</span>, implicando <strong>incremento esperado en las probabilidades</strong> cuando la observación pertenece al nivel de estudio respecto al nivel base.</p></li>
<li class="fragment"><p>Si <span class="math inline">\(\beta_i &lt; 0\)</span> entonces <span class="math inline">\(e^{\beta_1}&lt;1\)</span>, implicando <strong>disminución esperada en las probabilidades</strong> cuando la observación pertenece al nivel de estudio respecto al nivel base.</p></li>
</ul>
</section>
<section id="regresión-glm-para-var.-de-conteos-poisson" class="slide level2">
<h2>Regresión GLM para var. de Conteos: Poisson</h2>
<h4 id="función-de-enlace-logaritmo-natural">Función de enlace: logaritmo natural</h4>
<ul>
<li class="fragment"><p>La variable que sigue esta distribución proviene de un <strong>proceso de conteos</strong>.</p></li>
<li class="fragment"><p>La distribución de Poisson es discreta, toma <strong>valores enteros no negativos</strong>.</p></li>
<li class="fragment"><p>Es número de ocurrencias de un evento en un <strong>intervalo de tiempo o espacio dado</strong>.</p></li>
<li class="fragment"><p>Los eventos ocurren de manera <strong>independiente</strong> y a una <strong>tasa constante</strong> promedio lambda (<span class="math inline">\(\lambda\)</span>).</p></li>
<li class="fragment"><p>Asume que la media y la varianza son iguales, lo que se conoce como <strong>equidispersión</strong>.</p></li>
</ul>
</section>
<section id="regresión-glm-para-var.-de-conteos-efecto-multiplicativo" class="slide level2">
<h2>Regresión GLM para var. de Conteos: <br>efecto multiplicativo</h2>
<ul>
<li class="fragment"><p>El modelo de poisson es para una sola variable <span class="math inline">\(X\)</span> sería: <span class="math inline">\(\log(\mu)=\beta_0+\beta_ix_i+\varepsilon\)</span></p></li>
<li class="fragment"><p>Para despejar <span class="math inline">\(\mu\)</span> se exponencian ambos componentes (<span class="math inline">\(\varepsilon\)</span> no se considera en el cálculo):</p></li>
</ul>
<div class="fragment">
<div>
<p><span class="math display">\[
\begin{align}
\mu&amp;=e^{\beta_0+\beta_ix_i}\\
\mu&amp;=e^{\beta_0}*e^{\beta_ix_i}
\end{align}
\]</span></p>
</div>
</div>
<ul>
<li class="fragment">Considera <span class="math inline">\(\beta_0 = -0.339\)</span> y <span class="math inline">\(\beta_i = 0.256\)</span></li>
</ul>
<div class="fragment">
<div>
<p><span class="math display">\[
\begin{align}
\log(\mu)&amp;=-0.339+0.256x_i\\
\mu&amp;=e^{-0.339+0.256x_i}\\
\mu&amp;=e^{-0.339}*e^{0.256x_i}
\end{align}
\]</span></p>
</div>
</div>
</section>
<section id="regresión-glm-para-var.-de-conteos-efecto-multiplicativo-1" class="slide level2">
<h2>Regresión GLM para var. de Conteos: <br>efecto multiplicativo</h2>
<ul>
<li class="fragment"><p>Por lo tanto, una unidad de aumento en <span class="math inline">\(x_i\)</span> genera un aumento en conteo por un factor de <span class="math inline">\(e^{0.256*1}=1.292\)</span> unidades, con una confianza del 95%.</p></li>
<li class="fragment"><p>En otras palabras, la tasa de aumento de <span class="math inline">\(\mu\)</span> es de <span class="math inline">\(1.292 - 1 = 0.292 = 29.2%\)</span> por cada unidad de aumento de <span class="math inline">\(x_i\)</span>.</p></li>
</ul>
</section>
<section id="regresión-glm-para-var.-de-conteos-interpretación" class="slide level2">
<h2>Regresión GLM para var. de Conteos: interpretación</h2>
<ul>
<li class="fragment"><p>Si <span class="math inline">\(\beta_i = 0\)</span> entonces <span class="math inline">\(e^{\beta_1}=1\)</span>, implicando <strong>efecto nulo</strong>. Es decir, <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> no están asociadas.</p></li>
<li class="fragment"><p>Si <span class="math inline">\(\beta_i &gt; 0\)</span> entonces <span class="math inline">\(e^{\beta_1}&gt;1\)</span>, implicando <strong>incremento esperado en el conteo de</strong> <span class="math inline">\(Y\)</span> por cada unidad de <span class="math inline">\(X\)</span>.</p></li>
<li class="fragment"><p>Si <span class="math inline">\(\beta_i &lt; 0\)</span> entonces <span class="math inline">\(e^{\beta_1}&lt;1\)</span>, implicando <strong>disminución esperada en el conteo de</strong> <span class="math inline">\(Y\)</span> por cada unidad de <span class="math inline">\(X\)</span>.</p></li>
</ul>
</section>
<section id="regresión-glm-para-var.-de-conteos-datos-de-ratio" class="slide level2">
<h2>Regresión GLM para var. de Conteos: datos de ratio</h2>
<ul>
<li class="fragment"><p>Cuando la exposición cambia de observación a observación: <span class="math inline">\(c = \text{conteo}\)</span> y <span class="math inline">\(t = \text{tiempo de muestreo}\)</span>.</p></li>
<li class="fragment"><p>La variable <span class="math inline">\(Y\)</span> realmente es una tasa de ocurrencia, <span class="math inline">\(Y/t\)</span>, por tanto:</p></li>
</ul>
<div class="fragment">
<div>
<p><span class="math display">\[
E(Y/t)=\frac{1}{t}*E(Y)=\frac{E(Y)}{t}=\frac{\mu}{t}
\]</span></p>
</div>
</div>
<ul>
<li class="fragment">Gracias al vínculo de enlace logarítmico, <span class="math inline">\(t\)</span> ingresa al modelo como offset:</li>
</ul>
<div class="fragment">
<div>
<p><span class="math display">\[
\begin{align}
\log(E(Y/t)) = \log(\mu/t) &amp;= \beta_0+\beta_ix_i \\
\log(\mu) - \log(t)&amp;= \beta_0+\beta_ix_i \\
\log(\mu) &amp;= \beta_0+\beta_ix_i + \log(t)\\
\mu &amp;= e^{\beta_0}+e^{\beta_ix_i} + e^{\log(t)}\\
\mu &amp;= e^{\beta_0}+e^{\beta_ix_i} + t\\
\end{align}
\]</span></p>
</div>
</div>
</section>
<section id="regresión-glm-para-var.-de-conteos-sobredispersión" class="slide level2">
<h2>Regresión GLM para var. de Conteos: sobredispersión</h2>
<div class="columns">
<div class="column" style="width:65%;">
<div class="fragment">
<div>
<div class="cell" data-layout-align="center" data-hash="index_cache/revealjs/fig-13sobredis_873c45d6155dbdd444ad154942d205df">
<div class="cell-output-display">
<div id="fig-13sobredis" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="index_files/figure-revealjs/fig-13sobredis-1.svg" style="width:90.0%"></p>
<p></p><figcaption>Figura&nbsp;17: Cuando hay mayor varianza de la esperada por la distribución de poisson se tiene sobredispersión, y esta genera gráficos heterocedásticos como el aquí mostrado.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div><div class="column" style="width:35%;">
<ul>
<li class="fragment"><p>El parámetro de dispersión <span class="math inline">\(\phi\)</span> se asume como <span class="math inline">\(\phi=1\)</span> en un modelo de Poisson. Esto debido a que <span class="math inline">\(\mu = Var\)</span>, por tanto <span class="math inline">\(mu/Var = 1\)</span> (<strong>equidispersión</strong>).</p></li>
<li class="fragment"><p>Si la dispersión es mayor que 1, el modelo de Poisson puede subestimar la varianza y, por lo tanto, sobreestimar la significancia de las variables explicativas.</p></li>
<li class="fragment"><p>Solución: utilizar un modelo <strong>binomial negativo</strong>.</p></li>
</ul>
</div>
</div>
</section>
<section id="regresión-glm-para-var.-de-continuas-distribuciones" class="slide level2">
<h2>Regresión GLM para var. de Continuas: distribuciones</h2>
<ul>
<li class="fragment">Si la variable es de respuesta es numérica continua, puedes revisar la función de densidad de la misma para compararla con las principales distribuciones, como lo vimos anteriormente:</li>
</ul>
<div class="fragment">
<div>
<div class="cell" data-layout-align="center" data-hash="index_cache/revealjs/fig-014contidistri_68bd5c8bfcae47b7316c7be57a6920c3">
<div class="cell-output-display">
<div id="fig-014contidistri" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="index_files/figure-revealjs/fig-014contidistri-1.svg" style="width:100.0%"></p>
<p></p><figcaption>Figura&nbsp;18: Comparativa de las principales distribuciones de probabilidades continuas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="regresión-glm-para-var.-de-continuas-modelamiento" class="slide level2">
<h2>Regresión GLM para var. de Continuas: modelamiento</h2>
<p>Una alternativa más certera es el utilizar el criterio de información de Akaike (AIC) para comparar el ajuste de los modelos. A menos AIC, mejor el ajusto del modelo hacia los datos. (Usa <code>?stats::family</code>):</p>
<div class="cell" data-hash="index_cache/revealjs/unnamed-chunk-40_3377d2d973b798c0cadfaf2725262afe">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># Ajustar modelo GLM gaussiano</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>model_gaussian <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x, <span class="at">family =</span> <span class="fu">gaussian</span>())</span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co"># Ajustar modelo GLM lognormal</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>model_lognorm <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb15-6"><a href="#cb15-6"></a></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="co"># Ajustar modelo GLM gamma</span></span>
<span id="cb15-8"><a href="#cb15-8"></a>model_gamma <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x, <span class="at">family =</span> <span class="fu">Gamma</span>())</span>
<span id="cb15-9"><a href="#cb15-9"></a></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co"># Ajustar modelo GLM gamma-inverso</span></span>
<span id="cb15-11"><a href="#cb15-11"></a>model_gamma_inv <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x, <span class="at">family =</span> <span class="fu">inverse.gaussian</span>())</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="regresión-glm-para-var.-de-continuas-modelamiento-1" class="slide level2">
<h2>Regresión GLM para var. de Continuas: modelamiento</h2>
<p>Una alternativa más certera es el utilizar el criterio de información de Akaike (AIC) para comparar el ajuste de los modelos. A menos AIC, mejor el ajusto del modelo hacia los datos. (Usa <code>?stats::family</code>):</p>
<div class="cell" data-hash="index_cache/revealjs/unnamed-chunk-41_ba8657690ce153ac7c5c06d8fb7bca09">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># Ajustar modelo GLM gaussiano-inverso</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>model_gaussian_inv <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link =</span> <span class="st">"inverse"</span>))</span>
<span id="cb16-3"><a href="#cb16-3"></a></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co"># Ajustar modelo GLM exponencial</span></span>
<span id="cb16-5"><a href="#cb16-5"></a>model_exponential <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb16-6"><a href="#cb16-6"></a></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="co"># Comparar ajuste de modelos con AIC</span></span>
<span id="cb16-8"><a href="#cb16-8"></a>MuMIn<span class="sc">::</span><span class="fu">model.sel</span>(model_gaussian, model_lognorm, </span>
<span id="cb16-9"><a href="#cb16-9"></a>                 model_gamma, model_gamma_inv, </span>
<span id="cb16-10"><a href="#cb16-10"></a>                 model_gaussian_inv, model_exponential)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="regresión-glm-para-var.-de-continuas-modelamiento-2" class="slide level2">
<h2>Regresión GLM para var. de Continuas: modelamiento</h2>
<p>Una alternativa más certera es el utilizar el criterio de información de Akaike (AIC) para comparar el ajuste de los modelos. A menos AIC, mejor el ajusto del modelo hacia los datos. (Usa <code>?stats::family</code>):</p>
<div class="cell" data-hash="index_cache/revealjs/unnamed-chunk-42_791dcddd3ff45de9b2920284e8b2a7e4">
<div class="cell-output cell-output-stdout">
<pre><code>Model selection table 
                   (Intrc)        x      family df   logLik  AICc delta weight
model_exponential   0.6614 -0.07144        G(l)  3 -146.929 300.1  0.00  0.474
model_gamma         0.5172  0.03549       G(in)  3 -146.949 300.1  0.04  0.465
model_gamma_inv     0.2686  0.03660 in.g(1/m^2)  3 -148.986 304.2  4.11  0.061
model_gaussian      1.9410 -0.13200       g(id)  3 -163.837 333.9 33.82  0.000
model_lognorm       0.6612 -0.06686        g(l)  3 -163.849 333.9 33.84  0.000
model_gaussian_inv  0.5172  0.03455       g(in)  3 -163.853 334.0 33.85  0.000
Abbreviations:
 family: G(in) = 'Gamma(inverse)', G(l) = 'Gamma(log)', 
         g(id) = 'gaussian(identity)', g(in) = 'gaussian(inverse)', 
         g(l) = 'gaussian(log)', in.g(1/m^2) = 'inverse.gaussian(1/mu^2)'
Models ranked by AICc(x) </code></pre>
</div>
</div>
</section>
<section id="modelo-de-hurdle-exceso-de-ceros" class="slide level2">
<h2>Modelo de Hurdle: exceso de ceros</h2>

<img data-src="index_files/figure-revealjs/fig-15excesoceros-1.svg" class="r-stretch quarto-figure-center"><p class="caption">Figura&nbsp;19: Los modelos de Hurdle permiten lidiar con el exceso de ceros, lo cual es un problema frecuente en procesos de conteo (comúnmente ajustados con Poisson o Binomial Negativa).</p></section>
<section id="modelo-de-hurdle-los-modelos-internos" class="slide level2">
<h2>Modelo de Hurdle: Los modelos internos</h2>
<div class="columns">
<div class="column" style="width:35%;">
<p>El modelo de Hurdle se compone de dos partes:</p>
<ul>
<li class="fragment"><p><strong>Parte Poisson:</strong> (conditional, modelo de conteos) que modela la variable de respuesta para los valores mayores que cero. Es decir, modela los conteos (valores positivos).</p></li>
<li class="fragment"><p><strong>Parte Binomial:</strong> (zero inflated, modelo logístico) modela la probabilidad de que la variable de respuesta <span class="math inline">\(Y\)</span> sea cero. Determina si la variable de respuesta es cero o mayor que cero.</p></li>
</ul>
</div><div class="column" style="width:65%;">
<div class="cell" data-hash="index_cache/revealjs/unnamed-chunk-44_0a81e251b27ee336752942bc7aeb1552">
<div class="cell-output-display">
<p><img data-src="figs/Hurdle%20model%20IRR.png" style="width:80.0%"></p>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="modelos-con-efectos-mixtos-lmm-y-glmm" class="title-slide slide level1 center" data-background-image="fondoh1.png">
<h1>Modelos con efectos mixtos<br>(LMM y GLMM)</h1>

</section>
<section id="introducción-a-efectos-mixtos" class="slide level2">
<h2>Introducción a efectos mixtos</h2>
<h3 id="efectos-fijos">Efectos fijos</h3>
<p>Los modelos que hemos visto hasta el momento solo involucran un tipo de variable independiente <span class="math inline">\(X\)</span>: los efectos fijos.</p>
<div class="cell" data-hash="index_cache/revealjs/unnamed-chunk-45_b49821142e441410e9b347d577618897">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">glm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb18-2"><a href="#cb18-2"></a></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li class="fragment"><p>Siempre tenemos interés interpretativo en los efectos fijos.</p></li>
<li class="fragment"><p>Son factores o variables numéricas.</p></li>
</ul>
</section>
<section id="introducción-a-efectos-mixtos-1" class="slide level2">
<h2>Introducción a efectos mixtos</h2>
<h3 id="efectos-aleatorios">Efectos aleatorios</h3>
<p>Los efectos aleatorios:</p>
<ul>
<li class="fragment"><p>Incluyen variables factores (var. categóricas), con al menos 5 niveles.</p></li>
<li class="fragment"><p>No tenemos interés interpretativo en los efectos aleatorios.</p></li>
<li class="fragment"><p>Se usan para modelar la variabilidad en los datos que no puede ser explicada por las variables independientes <span class="math inline">\(X\)</span> (efectos fijos).</p></li>
<li class="fragment"><p>Dependiendo de la librería en R que se utilice, la sintaxis puede variar. Usaremos:</p></li>
</ul>
<div class="fragment">
<div>
<div class="cell" data-hash="index_cache/revealjs/unnamed-chunk-46_066185af6f181a3faa13bade141f00ed">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">glmer</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>ea1), <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb19-2"><a href="#cb19-2"></a></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="fu">lmer</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>ea1))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="introducción-a-efectos-mixtos-tipos-de-efectos-mixtos" class="slide level2">
<h2>Introducción a efectos mixtos: tipos de efectos mixtos</h2>
<p>Realizando gráficos exploratorios se puede predecir cuál será el mejor tipo de efecto aleatorio para nuestro modelo.</p>

<img data-src="figs/effmixtos.png" style="width:80.0%" class="r-stretch quarto-figure-center"><p class="caption">Figura&nbsp;20: Efectos aleatorios con pendientes e interceptos aleatorios (A). Efectos aleatorios solo con interceptos aleatorios (B). Modificado de <a href="https://peerj.com/articles/4794/">Harrison et al.&nbsp;(2018)</a>.</p></section>
<section id="pros-y-cons-de-los-modelos-de-efectos-mixtos" class="slide level2">
<h2>Pros y Cons de los modelos de efectos mixtos</h2>
<h3 id="ventajas">Ventajas</h3>
<ul>
<li class="fragment"><p>Proporciona una estimación más precisa de los parámetros del modelo.</p></li>
<li class="fragment"><p>Permite modelar la correlación entre las observaciones dentro de cada unidad de nivel superior. Correlación intra-clase (ICC).</p></li>
<li class="fragment"><p>Proporciona una manera de modelar la variabilidad no explicada por las variables independientes.</p></li>
</ul>
<h3 id="desventajas">Desventajas</h3>
<ul>
<li class="fragment"><p>La especificación del modelo puede ser compleja y requiere conocimientos preliminares, una comprensión de los datos y de las suposiciones subyacentes del modelo.</p></li>
<li class="fragment"><p>Son computacionalmente intensivos (GLMM usa integrales).</p></li>
</ul>
</section>
<section id="modelos-lineales-de-efectos-mixtos-lmm" class="slide level2">
<h2>Modelos Lineales de efectos mixtos (LMM)</h2>
<p>La forma más general de un modelo LMM puede expresarse como:</p>
<p><span class="math display">\[y = X\beta + Z\gamma + \varepsilon\]</span></p>
<p>Donde <span class="math inline">\(y\)</span> es el vector de respuestas, <span class="math inline">\(X\)</span> y <span class="math inline">\(Z\)</span> son las <strong>matrices de efectos fijos y aleatorios</strong>, respectivamente, <span class="math inline">\(\beta\)</span> y <span class="math inline">\(\gamma\)</span> son los vectores de parámetros desconocidos para los efectos fijos y aleatorios, respectivamente, y <span class="math inline">\(\varepsilon\)</span> es el vector de errores. Tanto <span class="math inline">\(\varepsilon\)</span> y <span class="math inline">\(\gamma\)</span> se asume que sigue una distribución normal estándar <span class="math inline">\(X \sim \mathcal{N}(\mu = 0,\,\sigma^{2})\)</span>.</p>
<h4 id="considera">Considera:</h4>
<ul>
<li class="fragment">En el modelo final LMM utilizar la <strong>máxima verosimilitud restringida (REML)</strong>, que es una forma de estimación (insesgada) de la verosimilitud que tiene en cuenta los grados de libertad perdidos por la estimación de los efectos aleatorios.</li>
</ul>
</section>
<section id="modelos-generalizados-lineales-de-efectos-mixtos-glmm" class="slide level2 smaller">
<h2>Modelos Generalizados Lineales de efectos mixtos (GLMM)</h2>
<p>La especificación de un modelo GLMM se puede escribir en términos matemáticos:</p>
<p><span class="math display">\[ y_i \mid b_i \sim F \]</span> <span class="math display">\[ g(\theta_i) = x_i \beta + z_i u_i \]</span> <span class="math display">\[ u_i \sim N(0,D) \]</span></p>
<h4 id="sean">Sean:</h4>
<div class="columns">
<div class="column">
<ul>
<li class="fragment"><p><span class="math inline">\(y_i\)</span> variable respuesta (dependiente).</p></li>
<li class="fragment"><p><span class="math inline">\(b_i\)</span> vector de covariables aleatorias.</p></li>
<li class="fragment"><p><span class="math inline">\(F\)</span> función de densidad de probabilidad<br>de la distribución condicional.</p></li>
<li class="fragment"><p><span class="math inline">\(\theta_i\)</span> función de la media condicional.</p></li>
<li class="fragment"><p><span class="math inline">\(g(\cdot)\)</span> función de enlace.</p></li>
</ul>
</div><div class="column">
<ul>
<li class="fragment"><p><span class="math inline">\(x_i\)</span> vector de covariables fijas (independientes).</p></li>
<li class="fragment"><p><span class="math inline">\(\beta\)</span> vector de coeficientes de regresión fijos.</p></li>
<li class="fragment"><p><span class="math inline">\(z_i\)</span> vector de covariables aleatorias.</p></li>
<li class="fragment"><p><span class="math inline">\(u_i\)</span> vector de efectos aleatorios.</p></li>
<li class="fragment"><p><span class="math inline">\(D\)</span> matriz de varianza-covarianza de eff. aleatorios.</p></li>
</ul>
</div>
</div>
</section></section>
<section id="gracias-por-su-atención" class="title-slide slide level1 center">
<h1>Gracias por su atención</h1>

<img src="logo.jpg" class="slide-logo r-stretch"><div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="index_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="index_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="index_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="index_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="index_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="index_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="index_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true,"theme":"chalkboard","boardmarkerWidth":5},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copiado");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copiado");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>